#Purpose: Installs DNS servers and completes DDNS Cycle
- name: Install bind package
  action: "{{ ansible_pkg_mgr }} name=bind state=present"
  notify:
    - start dns
  tags: named-packages

- name: update conf file
  template: src={{ item }}.j2 dest=/etc/named/{{ item }}  force=yes
  with_items:
    - named.conf
    - rndc.key
  notify:
    - restart dns
  tags: named-confs

- name: update zone file 
  template: src={{ item }}.j2 dest=/var/named/{{ item }}
  with_items:
  - example.com.db
  - example.com.rev.db
  notify:
    - restart dns
  tags: named-confs
    
- name: update permissions
  file: dest=/var/named owner=named group=named state=directory
  tags: named-confs

- name: update dns firewall settings
  firewalld: "service=named zone={{ firewall_zone }} permenant=true state=enabled"
  notify:
    - restart dns
  when : ansible_os_family == 'RedHat'
  tags: named-confs